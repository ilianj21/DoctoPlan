<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>{% block title %}Welcome!{% endblock %}</title>

    {# === Bootstrap CSS === #}
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-ENjdO4Dr2bkBIFxQpeoYz1+KcjFQpb6VIhb8+kI9KZe0p5h0VXWl5yGIU1YB7+4/"
      crossorigin="anonymous"
    >

    {% block stylesheets %}{% endblock %}
  </head>
  <body class="bg-light">

    {# === FLASH MESSAGES (une seule fois grâce au redirect) === #}
    <div class="container mt-3">
      {% for label, messages in app.flashes %}
        {% for message in messages %}
          <div class="alert alert-{{ label }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>
        {% endfor %}
      {% endfor %}
    </div>

    {# === CONTENU PRINCIPAL === #}
    <div class="container mt-4">
      {% block body %}{% endblock %}
    </div>

    {# === Bootstrap JS Bundle (Popper inclus) === #}
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
      crossorigin="anonymous"
    ></script>

    {# Optionnel : auto-fermeture après 5s #}
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        setTimeout(() => {
          document.querySelectorAll('.alert').forEach(el => {
            bootstrap.Alert.getOrCreateInstance(el).close();
          });
        }, 5000);
      });
    </script>

    {% block javascripts %}{% endblock %}
  </body>
</html>
